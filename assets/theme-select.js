!function(){class e extends HTMLElement{static #e=this.OPEN_ATTRIBUTE="open";#t;#i;#s;#n;#o;#a;constructor(){super(),this.#t=!1,this.#i=[]}connectedCallback(){this.#i=this.querySelectorAll("option"),this.updateSelectedOption(),this.value=this.selectedOption?.value??"",this.#n=this.attachShadow({mode:"open"}),this.render(),document.body.addEventListener("click",e=>{if(this.isOpen()){let t=this.getBoundingClientRect();e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height||this.close()}}),this.#t=!0}updateSelectedOption(){let e=Array.from(this.#i).find(e=>e.hasAttribute("selected")),t=Array.from(this.#i).find(e=>e.value==this.value),i=this.#i.length>0?this.#i[0]:null;this.selectedOption=e||t||i,null==this.selectedOption&&console.warn(`[${this.tagName}] Could not identify selected option.`)}render(){this.#n.innerHTML=`
      <div part="selected-value">
        <span>${this.selectedOption?.innerHTML??""}</span>
      </div>
      <div part="dropdown">
        ${Array.from(this.#i).map(e=>`<option part="option ${this.selectedOption==e?"selected":""} ${e.disabled?"disabled":""}" value="${e.value}" ${this.selectedOption==e?"selected":""} ${e.disabled?"disabled":""}>${e.innerHTML}</option>`).join("")}
      </div>
    `,this.#o=this.#n.querySelectorAll("option"),this.#o.forEach(e=>{e.addEventListener("click",()=>{this.value=e.value,this.selectOptionByValue(e.value),this.updateSelectedOption(),this.update(),this.close()})}),this.#a=this.#n.querySelector('div[part="selected-value"]'),this.#a.addEventListener("click",()=>{this.toggle()})}selectOptionByValue(e){this.#i.forEach(t=>t.value==e?t.setAttribute("selected",!0):t.removeAttribute("selected"))}update(){this.dispatchEvent(new Event("change")),this.render()}close(){this.removeAttribute(e.OPEN_ATTRIBUTE)}open(){this.setAttribute(e.OPEN_ATTRIBUTE,!0)}isOpen(){return this.hasAttribute(e.OPEN_ATTRIBUTE)}toggle(){this.isOpen()?this.close():this.open()}set value(e){this.#s=e,this.setAttribute("value",e)}get value(){return this.#s}static get observedAttributes(){return["name","value","id","open"]}attributeChangedCallback(t,i,s){if(i!==s){if("value"===t){this.selectOptionByValue(s),this.updateSelectedOption(),this.#t&&this.render();return}if(t===e.OPEN_ATTRIBUTE){this.hasAttribute(e.OPEN_ATTRIBUTE)?this.open():this.close();return}this[t]=s}}}customElements.define("theme-select",e),customElements.define("sort-by-select",class extends e{constructor(){super()}updateDeepLinking(){let e=new URL(location.href);e.searchParams.set("sort_by",this.sort_by),history.replaceState(null,"",e.href)}updateDOM(){this.sort_by=this.getAttribute("value");let e=new URL(location.href);e.searchParams.set("sort_by",this.sort_by),this.updateDeepLinking();let t=this.closest("[data-section-id]");if(t){let i=t.dataset.sectionId;i&&(t.classList.add("loading"),e.searchParams.set("section_id",i),fetch(e.href,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},method:"GET"}).then(e=>e.text()).then(e=>{let i=document.createElement("template");i.innerHTML=e.trim(),console.log("handle response TODO",i.content),t.classList.remove("loading")}).catch(function(e){t.classList.remove("loading"),console.error(e)}))}}connectedCallback(){super.connectedCallback(),super.addEventListener("change",this.updateDOM.bind(this))}})}();
//# sourceMappingURL=theme-select.js.map
