!function(){class e extends HTMLElement{static OPEN_ATTRIBUTE="open";#e=!1;#t=[];#s;#i;#n;#o;constructor(){super()}connectedCallback(){this.#t=this.querySelectorAll("option"),this.updateSelectedOption(),this.value=this.selectedOption?.value??"",this.#i=this.attachShadow({mode:"open"}),this.render(),document.body.addEventListener("click",e=>{if(this.isOpen()){let t=this.getBoundingClientRect();e.clientX>t.x&&e.clientX<t.x+t.width&&e.clientY>t.y&&e.clientY<t.y+t.height||this.close()}}),this.#e=!0}updateSelectedOption(){let e=Array.from(this.#t).find(e=>e.hasAttribute("selected")),t=Array.from(this.#t).find(e=>e.value==this.value),s=this.#t.length>0?this.#t[0]:null;this.selectedOption=e||t||s,null==this.selectedOption&&console.warn(`[${this.tagName}] Could not identify selected option.`)}render(){this.#i.innerHTML=`
      <div part="selected-value">
        <span>${this.selectedOption?.innerHTML??""}</span>
      </div>
      <div part="dropdown">
        ${Array.from(this.#t).map(e=>`<option part="option ${this.selectedOption==e?"selected":""} ${e.disabled?"disabled":""}" value="${e.value}" ${this.selectedOption==e?"selected":""} ${e.disabled?"disabled":""}>${e.innerHTML}</option>`).join("")}
      </div>
    `,this.#n=this.#i.querySelectorAll("option"),this.#n.forEach(e=>{e.addEventListener("click",()=>{this.value=e.value,this.selectOptionByValue(e.value),this.updateSelectedOption(),this.update(),this.close()})}),this.#o=this.#i.querySelector('div[part="selected-value"]'),this.#o.addEventListener("click",()=>{this.toggle()})}selectOptionByValue(e){this.#t.forEach(t=>t.value==e?t.setAttribute("selected",!0):t.removeAttribute("selected"))}update(){this.dispatchEvent(new Event("change")),this.render()}close(){this.removeAttribute(e.OPEN_ATTRIBUTE)}open(){this.setAttribute(e.OPEN_ATTRIBUTE,!0)}isOpen(){return this.hasAttribute(e.OPEN_ATTRIBUTE)}toggle(){this.isOpen()?this.close():this.open()}set value(e){this.#s=e,this.setAttribute("value",e)}get value(){return this.#s}static get observedAttributes(){return["name","value","id","open"]}attributeChangedCallback(t,s,i){if(s!==i){if("value"===t){this.selectOptionByValue(i),this.updateSelectedOption(),this.#e&&this.render();return}if(t===e.OPEN_ATTRIBUTE){this.hasAttribute(e.OPEN_ATTRIBUTE)?this.open():this.close();return}this[t]=i}}}customElements.define("theme-select",e),customElements.define("sort-by-select",class extends e{constructor(){super()}updateDeepLinking(){let e=new URL(location.href);e.searchParams.set("sort_by",this.sort_by),history.replaceState(null,"",e.href)}updateDOM(){this.sort_by=this.getAttribute("value");let e=new URL(location.href);e.searchParams.set("sort_by",this.sort_by),this.updateDeepLinking();let t=this.closest("[data-section-id]");if(t){let s=t.dataset.sectionId;s&&(t.classList.add("loading"),e.searchParams.set("section_id",s),fetch(e.href,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},method:"GET"}).then(e=>e.text()).then(e=>{let s=document.createElement("template");s.innerHTML=e.trim(),console.log("handle response TODO",s.content),t.classList.remove("loading")}).catch(function(e){t.classList.remove("loading"),console.error(e)}))}}connectedCallback(){super.connectedCallback(),super.addEventListener("change",this.updateDOM.bind(this))}})}();
//# sourceMappingURL=theme-select.js.map
