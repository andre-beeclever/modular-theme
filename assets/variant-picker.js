!function(){class e extends HTMLElement{constructor(){super()}connectedCallback(){for(let e of this.querySelectorAll("input.product-option-value"))e.addEventListener("input",t=>{this.setVariant(e.value)})}updateDOM(e,t){let a=this;a.classList.add("loading"),fetch(e,{credentials:"same-origin",headers:{"X-Requested-With":"XMLHttpRequest"},method:"GET"}).then(e=>e.text()).then(e=>{let n=document.createElement("template");n.innerHTML=e.trim(),console.log("handle response TODO",n.content),window.dispatchEvent(new CustomEvent("variant:changed",{bubbles:!0,cancelable:!1,detail:{variantId:t}})),a.classList.remove("loading")}).catch(function(e){a.classList.remove("loading"),console.error(e)})}updateURL(e,t){let a=new URL(document.location);e?a.searchParams.set("variant",e):a.searchParams.delete("variant"),t?a.searchParams.set("selling_plan",t):a.searchParams.delete("selling_plan"),history.replaceState(null,"",a.href)}setVariant(e){let t=this.closest("form.shopify-product-form").querySelector('input[name="selling_plan"]').value;this.updateURL(e,t);let a=this.dataset.sectionId;a||(a=this.closest("form")?.querySelector('input[name="section-id"]')?.value);let n=this.dataset.productUrl,s=`${n}?variant=${e}&selling_plan=${t}&section_id=${a}`;this.updateDOM(s,e)}}customElements.define("variant-picker",e)}();
//# sourceMappingURL=variant-picker.js.map
